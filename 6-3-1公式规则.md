在制作表单时，可以设置控件与控件之间的数据联动关系。同时也可以通过公式来实现一些自动计算的场景，例如编辑完单价和数量后，自动计算总价等这样的业务场景提供了支撑。

在了解函数怎么写之前，首先要了解公式的规则。

# 1. 函数在哪里设置

能做函数的控件，只有“单行文本”，“数字”，“多行文本”和“时间日期”这四个。

这四个字段每个都可以设置默认值，如果要编辑公式，那么这个默认值的选项要改成【公式编辑】，然后在其下方会出现“编辑公式”按钮，点击即可编辑公式。如下图

![](../img/6-3-1i1.png)

# 2. 函数的主体是什么

就是说，函数是计算什么的，原始数据是来自什么。

![](../img/6-3-1i2.png)

!> **注意： 所有的控件，都有一个内置的ID，而所能看见的控件名称，也仅仅是一个名称，所以当公式需要将控件值作为变量的时候，手动输入或复制粘贴都是无效的，因为字段名可以重复。如果需要将这个字段（控件）引入计算，需要手动点击左侧的字段列表。**

# 3. 公式规则

## （1）左侧面板选择字段

公式面板左侧可以选择公式所要用到的字段。一定要从左侧选择字段（蓝底），手写或者复制无效。除了MAPX函数之外，其他函数的字段都必须来自当前表单字段。

![](../img/6-3-1i3.png)

## （2）函数大写

函数在启辰云里的设置是大写，即在运用函数的时候，请用纯大写字母。函数会自动联想，正确的函数会变为紫红色。

![](../img/6-3-1i4.png)

## （3）运算符号

公式面板除了支持基本的运算操作符+、-、*、/，还支持比较操作符>、==、<、!=

| 加   |  减  |  乘  |  除  |  大于 |小于  | 等于  | 不等于 | 大于等于 | 小于等于 |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |  :--:  |  :--:  |  :--:  |
|  +   | -    |  *   |  /   |   >  |   <  |  ==  |     != |>=      |<=      |


## （4）数据类型匹配

函数运用时要注意参数数据类型和返回值数据类型，一定要对应，不对应则无法获得正确的结果。例如公式的返回值是一个字符串，则不能把这个公式写在日期控件或者数字控件中。

表单控件与其返回值的数据类型的对应关系如下表所示：

![](../img/6-3-1i5.png)

